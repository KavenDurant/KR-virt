# KR 虚拟化管理系统 - 双因子认证登录系统

## 🔐 系统概述

本系统实现了符合中国信创和国保测要求的双因子认证登录系统，包含以下安全特性：

- **双因子认证**: 密码 + 密钥文件 + 验证码三重验证
- **密码强度验证**: 实时检测密码安全性
- **密钥文件验证**: 支持.key、.pem、.crt 格式文件验证
- **安全加密**: 使用 AES256 加密标准
- **信创合规**: 符合国保三级安全要求

## 🚀 快速开始

### 1. 启动系统

```bash
npm run dev
```

### 2. 访问登录页面

打开浏览器访问: http://localhost:3001

### 3. 测试账户信息

| 用户名   | 密码           | 角色       | 权限             |
| -------- | -------------- | ---------- | ---------------- |
| admin    | Admin123!@#    | 系统管理员 | 全部权限         |
| operator | Operator123!@# | 操作员     | 虚拟机、网络管理 |
| auditor  | Auditor123!@#  | 审计员     | 审计、日志查看   |

### 4. 密钥文件

使用项目中的 `public/demo-auth-key.key` 文件进行测试

### 5. 验证码

系统提供测试验证码：**123456**、**666666**、**888888**

## 🔧 登录流程

### 第一步：基础认证

1. 输入用户名（支持实时验证）
2. 输入密码（带强度指示器）
3. 上传密钥文件
4. 点击"安全登录"

### 第二步：双因子认证

1. 点击"发送验证码"
2. 输入 6 位数字验证码
3. 点击"完成验证"

### 第三步：系统访问

登录成功后自动跳转到仪表盘

## 🛡️ 安全特性详解

### 密码安全要求

- ✅ 最少 8 位字符
- ✅ 包含大写字母
- ✅ 包含小写字母
- ✅ 包含数字
- ✅ 包含特殊字符
- ✅ 避免常见密码模式

### 密钥文件验证

- 支持格式：.key, .pem, .crt
- 文件大小限制：100KB 以内
- 内容验证：检查信创标识
- 签名验证：SHA256 数字签名

### 双因子认证

- 验证码长度：6 位数字
- 有效期：5 分钟
- 重发间隔：60 秒
- 错误限制：连续错误 3 次锁定

## 📱 界面特色

### 设计理念

- **简约大气**: 现代化渐变背景，毛玻璃效果
- **安全可信**: 专业的安全图标和提示信息
- **响应式**: 支持各种屏幕尺寸
- **无障碍**: 支持键盘导航和屏幕阅读器

### 视觉元素

- 🎨 渐变背景动画
- 🔒 安全状态指示器
- 📊 密码强度可视化
- ✨ 平滑过渡动画
- 🌓 支持明暗主题

## 🔍 技术架构

### 前端技术栈

- **React 19**: 最新版本，支持并发特性
- **TypeScript**: 类型安全，减少运行时错误
- **Ant Design**: 企业级 UI 组件库
- **React Router**: 声明式路由管理
- **Less**: CSS 预处理器

### 安全组件

- **AuthService**: 认证服务核心
- **SecurityUtils**: 安全工具集
- **AuthGuard**: 路由保护组件
- **TwoFactorAuth**: 双因子认证组件
- **PasswordStrengthIndicator**: 密码强度指示器

### 状态管理

- **LocalStorage**: 持久化认证信息
- **SessionStorage**: 临时会话数据
- **React State**: 组件内部状态

## 🚨 错误处理

### 常见错误及解决方案

#### 1. 密钥文件上传失败

**错误**: "密钥文件验证失败"
**解决**: 确保使用 `public/demo-auth-key.key` 文件

#### 2. 密码强度不足

**错误**: "密码强度不足，请参考安全建议"
**解决**: 按照密码要求设置复杂密码

#### 3. 验证码错误

**错误**: "验证码错误"
**解决**: 使用测试验证码：123456、666666、888888

#### 4. 会话过期

**错误**: "会话已过期，请重新登录"
**解决**: 重新开始登录流程

## 🔧 开发配置

### 环境要求

- Node.js >= 18.0.0
- npm >= 9.0.0
- 现代浏览器支持

### 开发命令

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build

# 代码格式化
npm run format

# 类型检查
npm run type-check
```

### 配置文件

- `tsconfig.json`: TypeScript 配置
- `vite.config.ts`: Vite 构建配置
- `eslint.config.js`: 代码规范配置

## 📋 测试清单

### 功能测试

- [ ] 用户名验证
- [ ] 密码强度检测
- [ ] 密钥文件上传
- [ ] 第一步登录验证
- [ ] 验证码发送
- [ ] 双因子认证
- [ ] 登录成功跳转
- [ ] 登出功能
- [ ] 路由保护

### 安全测试

- [ ] SQL 注入防护
- [ ] XSS 攻击防护
- [ ] 文件上传安全
- [ ] 会话管理
- [ ] 权限控制

### 兼容性测试

- [ ] Chrome 浏览器
- [ ] Firefox 浏览器
- [ ] Edge 浏览器
- [ ] 移动端适配
- [ ] 平板适配

## 🎯 信创合规要点

### 国保三级要求

- ✅ 用户身份鉴别
- ✅ 访问控制机制
- ✅ 安全审计功能
- ✅ 数据完整性保护
- ✅ 数据保密性保护

### 技术标准

- ✅ 国产化密码算法
- ✅ 安全通信协议
- ✅ 身份认证标准
- ✅ 访问控制标准
- ✅ 安全审计标准

## 📞 技术支持

如有问题请联系：

- 开发者：KavenDurant
- 邮箱：luojiaxin888@gmail.com
- 文档更新：2025-05-27

---

**注意**: 本系统仅用于演示目的，生产环境请根据实际安全要求进行相应调整。
