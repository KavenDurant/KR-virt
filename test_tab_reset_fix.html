<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ ‡ç­¾é¡µé‡ç½®ä¿®å¤æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #e8e8e8;
            border-radius: 6px;
        }
        .test-title {
            font-size: 18px;
            font-weight: bold;
            color: #1890ff;
            margin-bottom: 10px;
        }
        .test-button {
            background: #1890ff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        .test-button:hover {
            background: #40a9ff;
        }
        .test-button.secondary {
            background: #52c41a;
        }
        .test-button.secondary:hover {
            background: #73d13d;
        }
        .test-button.warning {
            background: #faad14;
        }
        .test-button.warning:hover {
            background: #ffc53d;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            background: #f6ffed;
            border: 1px solid #b7eb8f;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
        }
        .error {
            background: #fff2f0;
            border-color: #ffccc7;
            color: #ff4d4f;
        }
        .success {
            background: #f6ffed;
            border-color: #b7eb8f;
            color: #52c41a;
        }
        .warning {
            background: #fffbe6;
            border-color: #ffe58f;
            color: #d48806;
        }
        .current-state {
            background: #f0f2f5;
            border: 1px solid #d9d9d9;
            padding: 10px;
            border-radius: 4px;
            margin-top: 15px;
        }
        .scenario {
            background: #e6f7ff;
            border: 1px solid #91d5ff;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ä¸»æœºè¯¦æƒ…æ ‡ç­¾é¡µé‡ç½®ä¿®å¤æµ‹è¯•</h1>
        <p>è¿™ä¸ªæµ‹è¯•é¡µé¢ç”¨äºéªŒè¯ä¸»æœºè¯¦æƒ…æ ‡ç­¾é¡µåœ¨ä¾§è¾¹æ é€‰æ‹©å˜åŒ–æ—¶æ˜¯å¦æ­£ç¡®é‡ç½®åˆ°é»˜è®¤çŠ¶æ€ã€‚</p>
        
        <div class="current-state">
            <strong>å½“å‰çŠ¶æ€ï¼š</strong>
            <div id="current-state">
                é€‰æ‹©çš„ä¸»æœº: <span id="selected-host">æ— </span><br>
                ä¸»æœºè¯¦æƒ…æ ‡ç­¾é¡µ: <span id="host-tab">basic</span>
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">é—®é¢˜åœºæ™¯é‡ç°</div>
            <div class="scenario">
                <strong>é—®é¢˜åœºæ™¯ï¼š</strong><br>
                1. é€‰æ‹© node155 ä¸»æœºï¼Œåˆ‡æ¢åˆ°"ç¡¬ä»¶ä¿¡æ¯"æ ‡ç­¾é¡µ<br>
                2. é€‰æ‹© br0 ç½‘ç»œè®¾å¤‡ï¼ˆæ¸…ç©ºä¸»æœºé€‰æ‹©ï¼‰<br>
                3. å†æ¬¡é€‰æ‹© node155 ä¸»æœº<br>
                4. <strong>æœŸæœ›ï¼š</strong>æ˜¾ç¤º"åŸºæœ¬ä¿¡æ¯"æ ‡ç­¾é¡µ<br>
                5. <strong>ä¿®å¤å‰ï¼š</strong>ä»æ˜¾ç¤º"ç¡¬ä»¶ä¿¡æ¯"æ ‡ç­¾é¡µ
            </div>
            
            <button class="test-button" onclick="step1()">æ­¥éª¤1: é€‰æ‹© node155 ä¸»æœº</button>
            <button class="test-button secondary" onclick="step2()">æ­¥éª¤2: åˆ‡æ¢åˆ°"ç¡¬ä»¶ä¿¡æ¯"æ ‡ç­¾é¡µ</button>
            <button class="test-button warning" onclick="step3()">æ­¥éª¤3: é€‰æ‹© br0 ç½‘ç»œè®¾å¤‡</button>
            <button class="test-button" onclick="step4()">æ­¥éª¤4: å†æ¬¡é€‰æ‹© node155 ä¸»æœº</button>
            <button class="test-button" onclick="resetTest()">é‡ç½®æµ‹è¯•</button>
            
            <div id="scenario-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <div class="test-title">æµ‹è¯•1: åŒä¸€ä¸»æœºé‡æ–°é€‰æ‹©</div>
            <p>æµ‹è¯•é€‰æ‹©åŒä¸€ä¸»æœºæ—¶æ ‡ç­¾é¡µæ˜¯å¦é‡ç½®</p>
            <button class="test-button" onclick="testSameHostReselection()">æµ‹è¯•åŒä¸€ä¸»æœºé‡æ–°é€‰æ‹©</button>
            <div id="same-host-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <div class="test-title">æµ‹è¯•2: ä¸åŒä¸»æœºåˆ‡æ¢</div>
            <p>æµ‹è¯•åˆ‡æ¢åˆ°ä¸åŒä¸»æœºæ—¶æ ‡ç­¾é¡µæ˜¯å¦é‡ç½®</p>
            <button class="test-button" onclick="testDifferentHostSwitch()">æµ‹è¯•ä¸åŒä¸»æœºåˆ‡æ¢</button>
            <div id="different-host-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <div class="test-title">æµ‹è¯•3: ç½‘ç»œè®¾å¤‡é€‰æ‹©åé‡æ–°é€‰æ‹©ä¸»æœº</div>
            <p>æµ‹è¯•é€‰æ‹©ç½‘ç»œè®¾å¤‡åå†é€‰æ‹©ä¸»æœºæ—¶æ ‡ç­¾é¡µæ˜¯å¦é‡ç½®</p>
            <button class="test-button" onclick="testNetworkToHostSwitch()">æµ‹è¯•ç½‘ç»œè®¾å¤‡åˆ°ä¸»æœºåˆ‡æ¢</button>
            <div id="network-host-result" class="result" style="display: none;"></div>
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿåº”ç”¨çŠ¶æ€
        let appState = {
            selectedHost: null,
            selectedNetwork: null,
            hostDetailActiveTab: 'basic'
        };

        // æ¨¡æ‹Ÿä¿®å¤åçš„é€»è¾‘
        function simulateHostSelection(hostName) {
            console.log(`é€‰æ‹©ä¸»æœº: ${hostName}`);
            
            // æ¨¡æ‹Ÿä¿®å¤åçš„é€»è¾‘ï¼šé‡ç½®æ ‡ç­¾é¡µåˆ°é»˜è®¤çŠ¶æ€
            appState.selectedHost = hostName;
            appState.selectedNetwork = null;
            appState.hostDetailActiveTab = 'basic'; // é‡ç½®åˆ°é»˜è®¤æ ‡ç­¾é¡µ
            
            updateCurrentState();
            
            console.log(`ä¸»æœºè¯¦æƒ…æ ‡ç­¾é¡µé‡ç½®åˆ°: ${appState.hostDetailActiveTab}`);
        }

        function simulateNetworkSelection(networkName) {
            console.log(`é€‰æ‹©ç½‘ç»œè®¾å¤‡: ${networkName}`);
            
            appState.selectedHost = null;
            appState.selectedNetwork = networkName;
            // ç½‘ç»œè®¾å¤‡æ²¡æœ‰æ ‡ç­¾é¡µçŠ¶æ€
            
            updateCurrentState();
        }

        function simulateTabSwitch(tabKey) {
            if (appState.selectedHost) {
                console.log(`åˆ‡æ¢ä¸»æœºè¯¦æƒ…æ ‡ç­¾é¡µåˆ°: ${tabKey}`);
                appState.hostDetailActiveTab = tabKey;
                updateCurrentState();
            }
        }

        function updateCurrentState() {
            document.getElementById('selected-host').textContent = appState.selectedHost || 'æ— ';
            document.getElementById('host-tab').textContent = appState.hostDetailActiveTab;
        }

        // é—®é¢˜åœºæ™¯é‡ç°æ­¥éª¤
        function step1() {
            simulateHostSelection('node155');
            showResult('scenario-result', 'success', 'âœ… æ­¥éª¤1å®Œæˆï¼šé€‰æ‹©äº† node155 ä¸»æœºï¼Œæ ‡ç­¾é¡µé‡ç½®ä¸º"åŸºæœ¬ä¿¡æ¯"');
        }

        function step2() {
            simulateTabSwitch('hardware');
            showResult('scenario-result', 'success', 'âœ… æ­¥éª¤2å®Œæˆï¼šåˆ‡æ¢åˆ°"ç¡¬ä»¶ä¿¡æ¯"æ ‡ç­¾é¡µ');
        }

        function step3() {
            simulateNetworkSelection('br0');
            showResult('scenario-result', 'success', 'âœ… æ­¥éª¤3å®Œæˆï¼šé€‰æ‹©äº† br0 ç½‘ç»œè®¾å¤‡ï¼Œæ¸…ç©ºäº†ä¸»æœºé€‰æ‹©');
        }

        function step4() {
            simulateHostSelection('node155');
            
            if (appState.hostDetailActiveTab === 'basic') {
                showResult('scenario-result', 'success', 
                    'âœ… æ­¥éª¤4å®Œæˆï¼šå†æ¬¡é€‰æ‹© node155 ä¸»æœºï¼Œæ ‡ç­¾é¡µæ­£ç¡®é‡ç½®ä¸º"åŸºæœ¬ä¿¡æ¯"<br>' +
                    'ğŸ‰ ä¿®å¤æˆåŠŸï¼æ ‡ç­¾é¡µçŠ¶æ€ç®¡ç†æ­£å¸¸å·¥ä½œ');
            } else {
                showResult('scenario-result', 'error', 
                    'âŒ æ­¥éª¤4å¤±è´¥ï¼šæ ‡ç­¾é¡µæ²¡æœ‰é‡ç½®ï¼Œä»ç„¶æ˜¯"' + appState.hostDetailActiveTab + '"<br>' +
                    'ğŸ› è¿™è¡¨æ˜ä¿®å¤æ²¡æœ‰ç”Ÿæ•ˆ');
            }
        }

        function resetTest() {
            appState = {
                selectedHost: null,
                selectedNetwork: null,
                hostDetailActiveTab: 'basic'
            };
            updateCurrentState();
            hideAllResults();
            showResult('scenario-result', 'warning', 'ğŸ”„ æµ‹è¯•å·²é‡ç½®ï¼Œå¯ä»¥é‡æ–°å¼€å§‹');
        }

        // æµ‹è¯•å‡½æ•°
        function testSameHostReselection() {
            // é€‰æ‹©ä¸»æœºå¹¶åˆ‡æ¢æ ‡ç­¾é¡µ
            simulateHostSelection('node155');
            simulateTabSwitch('performance');
            
            // é‡æ–°é€‰æ‹©åŒä¸€ä¸»æœº
            simulateHostSelection('node155');
            
            if (appState.hostDetailActiveTab === 'basic') {
                showResult('same-host-result', 'success', 
                    'âœ… æµ‹è¯•é€šè¿‡ï¼šé‡æ–°é€‰æ‹©åŒä¸€ä¸»æœºæ—¶ï¼Œæ ‡ç­¾é¡µæ­£ç¡®é‡ç½®ä¸º"åŸºæœ¬ä¿¡æ¯"');
            } else {
                showResult('same-host-result', 'error', 
                    'âŒ æµ‹è¯•å¤±è´¥ï¼šæ ‡ç­¾é¡µæ²¡æœ‰é‡ç½®ï¼Œå½“å‰ä¸º"' + appState.hostDetailActiveTab + '"');
            }
        }

        function testDifferentHostSwitch() {
            // é€‰æ‹©ç¬¬ä¸€ä¸ªä¸»æœºå¹¶åˆ‡æ¢æ ‡ç­¾é¡µ
            simulateHostSelection('node155');
            simulateTabSwitch('hardware');
            
            // åˆ‡æ¢åˆ°ä¸åŒä¸»æœº
            simulateHostSelection('node156');
            
            if (appState.hostDetailActiveTab === 'basic') {
                showResult('different-host-result', 'success', 
                    'âœ… æµ‹è¯•é€šè¿‡ï¼šåˆ‡æ¢åˆ°ä¸åŒä¸»æœºæ—¶ï¼Œæ ‡ç­¾é¡µæ­£ç¡®é‡ç½®ä¸º"åŸºæœ¬ä¿¡æ¯"');
            } else {
                showResult('different-host-result', 'error', 
                    'âŒ æµ‹è¯•å¤±è´¥ï¼šæ ‡ç­¾é¡µæ²¡æœ‰é‡ç½®ï¼Œå½“å‰ä¸º"' + appState.hostDetailActiveTab + '"');
            }
        }

        function testNetworkToHostSwitch() {
            // é€‰æ‹©ä¸»æœºå¹¶åˆ‡æ¢æ ‡ç­¾é¡µ
            simulateHostSelection('node155');
            simulateTabSwitch('hardware');
            
            // é€‰æ‹©ç½‘ç»œè®¾å¤‡
            simulateNetworkSelection('br0');
            
            // é‡æ–°é€‰æ‹©ä¸»æœº
            simulateHostSelection('node155');
            
            if (appState.hostDetailActiveTab === 'basic') {
                showResult('network-host-result', 'success', 
                    'âœ… æµ‹è¯•é€šè¿‡ï¼šä»ç½‘ç»œè®¾å¤‡åˆ‡æ¢å›ä¸»æœºæ—¶ï¼Œæ ‡ç­¾é¡µæ­£ç¡®é‡ç½®ä¸º"åŸºæœ¬ä¿¡æ¯"<br>' +
                    'è¿™æ­£æ˜¯åŸé—®é¢˜åœºæ™¯ï¼Œç°åœ¨å·²ä¿®å¤ï¼');
            } else {
                showResult('network-host-result', 'error', 
                    'âŒ æµ‹è¯•å¤±è´¥ï¼šæ ‡ç­¾é¡µæ²¡æœ‰é‡ç½®ï¼Œå½“å‰ä¸º"' + appState.hostDetailActiveTab + '"<br>' +
                    'è¿™æ˜¯åŸé—®é¢˜åœºæ™¯ï¼Œä¿®å¤å¯èƒ½æ²¡æœ‰ç”Ÿæ•ˆ');
            }
        }

        function showResult(elementId, type, message) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.className = 'result ' + type;
            element.innerHTML = message;
        }

        function hideAllResults() {
            const results = document.querySelectorAll('.result');
            results.forEach(result => {
                result.style.display = 'none';
            });
        }

        // åˆå§‹åŒ–
        updateCurrentState();
    </script>
</body>
</html>
